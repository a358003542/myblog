Title: django后台api编写之-翻译
Date: 2018-05-26

[TOC]

## 翻译

django的翻译其实已经很便捷了，因为我关注于后台api的编写，所以实际上很多教程说的：

```
TEMPLATES = [
    {
        ...
        'OPTIONS': {
            'context_processors': [
                ...
                'django.template.context_processors.i18n',
            ],
        },
    },
]
```

这个配置只和模板输出的翻译有关，有需要再加上。

然后MIDDLESWARES 哪里要加上：

```
    'django.middleware.locale.LocaleMiddleware',
```

然后就是这些配置：

```
LANGUAGE_CODE = 'zh-Hans'

USE_I18N = True
```

设置好你的语言代码，这是没有问题的。

我看了一下 django restframework 的翻译管理相关，发现大体这样配置就可以了，很多教程说的设置 `LOCALE_PATHS` 变量觉得没必要，默认的每个app下面的locale文件夹够用了。

然后就是目标py文件下的 字符串 如下装饰之：

```
from django.utils.translation import ugettext_lazy as _
...

        if username is None:
            raise TypeError(_('Users must have a username.'))
```

Model字段定义的名字可以加上，verbose_name 可以加上，然后异常信息可以加上等等。

加完了之后运行：

```
django-admin makemessages -l zh_Hans 
```

app下面没有locale文件夹的创建个就是了，某些文件你不想管，比如 manage.py ，那么加上 `--ignore` 选项即可。

windows下不是很方便，推荐在linux服务器下创建了目标 django.po 文件，然后再修改文件即可。其中po文件的头部有些东西，估计：

```
"Language: zh-Hans\n"
```

已经是必填的，其他有时间也填上吧。

然后运行:

```
django-admin compilemessages 
```

如果不出意外的，翻译就已经生效了。







