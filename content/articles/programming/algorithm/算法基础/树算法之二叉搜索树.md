Category: algorithm
Tags: algorithm
Slug: binary-search-tree
Date: 20190909

[TOC]



## 二叉搜索树

二叉搜索树（Binary Search Tree）:

![img]({static}/images/python/binary_search_tree.png  "二叉搜索树")

其每一个节点都至多有两个子节点，然后所有的节点都满足以下三个条件

1.  左节点的值小于它的父节点
2.  右节点的值大于它的父节点
3.  所有节点的值均不相等

二叉搜索树的插入复杂度是 `O(log n)` ，查找复杂度最好情况 `O(log n)` ，最坏情况 `O(n)` 。

比如上面图片的那个二叉树，假设我们要插入19，那么首先和8比较，大，则右，再和10比较，大则右，再和14比较，大则右，然后空就可以插入了。

然后假设我们要查找19，那么过程大体也是类似的和8比较，大则右，再和10比较，大则右，再和14比较，大则右，然后相等则找到。



## 基本实现

我们在 [树算法建模初步]({filename}./树算法建模初步.md)  中构建的Tree类继续来实现 BinarySearchTree 类。首先我们定义目标节点的左节点left和右节点right，一个是children的第一个元素，一个是children的第二个元素。

```python
    @property
    def left(self):
        if len(self.children) == 0:
            self.children = [None, None]
        elif len(self.children) == 1:
            self.children.append(None)

        return self.children[0]

    @left.setter
    def left(self, node):
        self.children[0] = node

    @property
    def right(self):
        if len(self.children) == 0:
            self.children = [None, None]
        elif len(self.children) == 1:
            self.children.append(None)

        return self.children[1]

    @right.setter
    def right(self, node):
        self.children[-1] = node
```

### 插入动作

按照二叉搜索树的定义，我们需要编写插入动作和查找动作。普通的树要插入某个节点是需要指明在那个父节点插入的，而二叉搜索树是说我要插入什么节点就直接往整个树上插入的，具体位置会自动计算得到的。此外二叉搜索树插入动作和查找动作依赖于一个比较大小的过程，树的节点的name是随意的字符串，并不是很好比较大小。

下面比较大小将会采用python的hash函数。通过 `hash(object)` 也就是调用object的 `__hash__` 方法。值得一提的是这里的比较大小，并不具有某种实际意义，比如:

    >>> hash(11)> hash("22")
    True

```python
    def insert(self, name):
        if hash(name) < hash(self.name):
            if self.left is None:
                self.left = BinarySearchTree(name, parent=self)
            else:
                self.left.insert(name)
        elif hash(name) > hash(self.name):
            if self.right is None:
                self.right = BinarySearchTree(name, parent=self)
            else:
                self.right.insert(name)
        else:
            self.name = name
```

插入动作的代码过程非常清晰，几乎和上面描述的二叉搜索树的定义过程类似。小的往左边插，大的往右边插。

### 查找动作

查找动作也类似上面插入动作的描述：

```python
    def find(self, name):
        if hash(name) < hash(self.name):
            if self.left is None:
                return False
            else:
                return self.left.find(name)
        elif hash(name) > hash(self.name):
            if self.right is None:
                return False
            else:
                return self.right.find(name)
        else:
            return self
```





## 参考资料

1.  [http://www.laurentluce.com/posts/binary-search-tree-library-in-python/](http://www.laurentluce.com/posts/binary-search-tree-library-in-python/)
2.  [二叉搜索树wiki](https://zh.wikipedia.org/wiki/二元搜尋樹)
